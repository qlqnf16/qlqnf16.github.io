---
layout: post

title: "[Network] ICMP"

tags: [computer-science, network]

date: 2019-10-20
---

**ICMP(Internet Control Message Protocol)** 에 대해 알아보자

---

ICMP는 TCP/IP 계층 중 **네트워크 계층**에 위치하는 프로토콜로, **IP 동작을 진단 및 제어**하는 데 사용된다. IP 프로토콜을 이용해 상황 및 오류 보고, 위험 경보 등의 메시지를 전달함으로써 네트워크 계층의 관리 역할을 수행한다.

## ICMP 명령어

### Ping(packet internet grouper)

Ping은 컴퓨터 네트워크 상태를 점검, 진단하는 명령어를 말한다. **IP 기반의 네트워크에 연결된 호스트끼리의 접속성 확인**에 사용되며 응답이 돌아올 때까지 반환 시간과, 상대방 도달 경로의 혼잡 상황도 알아낼 수 있다.

Ping의 기능

> - 현재 네트워크 상태 체크
> - 호스트 접근 가능여부 체크
> - 호스트의 작동 여부 및 응답시간 체크

네트워크 상태를 확인하려는 대상(target)을 향해 일정 크기의 패킷을 보낸 후(**ICMP echo request**), 대상 컴퓨터가 이에 대해 응답하는 메시지(**ICMP echo reply**)를 보내면 이를 수신, 분석하여 대상 컴퓨터가 작동하는지, 또는 대상 컴퓨터까지 도달하는 네트워크 상태가 어떠한지 파악할 수 있다.

Ping 테스트를 수행하는 방법은 간단하다. 콘솔에서 `ping [ip주소/도메인 주소] [옵션]` 명령어 를 입력하면 자동으로 패킷을 보내 메세지를 수신한다.

![](/assets/images/ping.png)

직접 해 보았다. 신기하다〰️

### Tracert(Trace Route)

지정된 호스트에 도달할 때까지 **통과하는 경로의 정보**와 **각 경로에서의 지연 시간**을 추적하는 명령이다, 쉽게 경로 추적 툴이라고 볼 수 있다. Ping 테스트는 패킷이 제대로 도착하는 지만 알 수 있다면, Tracert를 이용해 목적지 IP까지 가는데 어떤 경로를 거치는지, 각 경로에서의 시간은 어떤지 알 수 있다.

수행 방법은 Ping 과 같다. 윈도우는 `tracert [ip주소]` 맥은 `traceroute [ip주소]` 를 터미널에 입력하면 바로 결과가 출력된다. 이번에는 구글의 IP 주소로 접근을 해봤다. 내 서버 (192.168.1.1)부터 출발해서 최종 목적지까지 가는 경로와 응답시간이 표시된다. 이를 이용하면 서버 간 연결에서 어떤 부분에서 병목 현상이 일어나는 지를 찾아 성능을 개선하는 데 쓸 수도 있다고 한다.

![](/assets/images/traceroute.png)

#### 🤔 ping, tracert 를 맹신할 수 없는 이유

예를 들어 Ping이나 tracert를 `www.naver.com`에 대해 진행하면 모두 실패한다. Ping 테스트에서는 request timout이 출력되고, tracert를 실행하면 경로 중간부터 응답이 오지 않는다. 그렇다면 네이버에 연결이 안 되는 걸까? 직접 접속해보면 문제 없이 너무 잘 된다.

ICMP가 정상적인 응답을 보이지 않는 이유는 **네이버가 방화벽으로 ICMP의 접근을 차단해놓았기 때문**이다. ICMP는 네트워크 환경을 테스트하는 데 사용되지만, 동시에 **공격의 수단**으로 사용될 수도 있다. 따라서 일부 사이트는 ICMP의 접근을 차단해 놓는 것이다.

### 참고자료

> - [ICMP란 무엇인가?](https://run-it.tistory.com/31)
> - [IP확인: ping, tracert, nslookup](https://ojava.tistory.com/126)
